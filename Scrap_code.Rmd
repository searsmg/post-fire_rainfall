---
title: "Scrap code"
author: "Megan Sears"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: journal
editor_options:
  chunk_output_type: console
---

```{r, include = F}

knitr::opts_chunk$set(echo = F,
                      message = F,
                      fig.width = 12,
                      fig.height = 6)

library(tidyverse)
library(lubridate)
library(plotly)
library(kableExtra)
library(here)
library(ggplot2); theme_set(theme_bw(base_size = 16))

```

# Finish processing soil data

```{r}
# ETF
etf_soil <- read_csv('/Users/megansears/Documents/Repos/post-fire_rainfall/data/etf_soil.csv')

etf_soil_summary <- etf_soil %>%
  mutate(weight = shape_km2 / Area__km2) %>%
  group_by(Name) %>%
  summarize(ksat_wmean = weighted.mean(AVG_KSAT, weight, na.rm  = T),
            sand_wmean = weighted.mean(AVG_SAND, weight, na.rm  = T),
            silt_wmean = weighted.mean(AVG_SILT, weight, na.rm  = T),
            clay_wmean = weighted.mean(AVG_CLAY, weight, na.rm  = T))
         
  
write_csv(etf_soil_summary, './data/etf_soil_wmean.csv')

# Bennett
benn_soil <- read_csv('/Users/megansears/Documents/Repos/post-fire_rainfall/data/benn_soils_areaweight.csv')

benn_soil_summary <- benn_soil %>%
  mutate(weight = shape_km2 / total_area_km2) %>%
  group_by(FID_bennett_catchments_original6) %>%
  summarize(ksat_wmean = weighted.mean(AVG_KSAT, weight, na.rm  = T),
            sand_wmean = weighted.mean(AVG_SAND, weight, na.rm  = T),
            silt_wmean = weighted.mean(AVG_SILT, weight, na.rm  = T),
            clay_wmean = weighted.mean(AVG_CLAY, weight, na.rm  = T)) %>%
  arrange(FID_bennett_catchments_original6)

  
write_csv(benn_soil_summary, './data/benn_soil_wmean.csv')

```

# Extracting some precip time series for SK

```{r}

dates_to_filter <- c("2022-07-6", "2022-07-15", "2022-07-27")

all_2022 <- read_csv('/Users/megansears/Documents/MRMS/correctedSPR/2022/catchments_2022_mrms.csv') %>%
  dplyr::select(-1) %>%
  filter(date(datetime) %in% ymd(dates_to_filter),
         ID %in% c('me', 'mm', 'mw', 'ue', 'um', 'uw'))

looking <- ggplot(all_2022, aes(datetime, p_mm)) + geom_line()

ggplotly(looking)

write.csv(all_2022, 'mrms_july_2022_benn.csv')

```

